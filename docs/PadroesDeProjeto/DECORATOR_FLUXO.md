# Fluxo de Execu√ß√£o do Padr√£o Decorator - CuidaDeMim

## üîÑ Diagrama de Sequ√™ncia

```
Cliente                AutenticadorDecorator     ValidadorDecorator      CadastroPetSimples      NotificadorDecorator
   |                            |                        |                       |                         |
   |---- cadastrar(pet) ------->|                        |                       |                         |
   |                            |                        |                       |                         |
   |                    [Verifica autentica√ß√£o]          |                       |                         |
   |                            |                        |                       |                         |
   |                            |---- cadastrar(pet) --->|                       |                         |
   |                            |                        |                       |                         |
   |                            |                [Valida dados do pet]           |                         |
   |                            |                        |                       |                         |
   |                            |                        |--- cadastrar(pet) --->|                         |
   |                            |                        |                       |                         |
   |                            |                        |                [Salva no banco]                  |
   |                            |                        |                       |                         |
   |                            |                        |                       |--- cadastrar(pet) ----->|
   |                            |                        |                       |                         |
   |                            |                        |                       |                  [Envia notifica√ß√£o]
   |                            |                        |                       |                         |
   |                            |                        |                       |<----- resultado --------|
   |                            |                        |<----- resultado ------|                         |
   |                            |<------ resultado ------|                       |                         |
   |<----- resultado -----------|                        |                       |                         |
   |                            |                        |                       |                         |
```

## üìä Estrutura da Cadeia de Decoradores

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Fluxo de Execu√ß√£o                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

    PetsController
          ‚îÇ
          ‚îÇ 1. Cria Pet via Factory
          ‚îÇ
          ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ cadastrar_com_       ‚îÇ
    ‚îÇ decorators(pet)      ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚îÇ 2. Constr√≥i a cadeia
          ‚îÇ
          ‚ñº
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë AutenticadorDecorator‚ïë  ‚óÑ‚îÄ‚îÄ‚îÄ Camada Externa (executa primeiro)
    ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
    ‚ïë @autenticado = true  ‚ïë
    ‚ïë @parceiro = "..."    ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
          ‚îÇ wraps
          ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ ValidadorDecorator   ‚îÇ  ‚óÑ‚îÄ‚îÄ‚îÄ Camada Intermedi√°ria
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    ‚îÇ valida_pet(pet)      ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ wraps
          ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ NotificadorDecorator ‚îÇ  ‚óÑ‚îÄ‚îÄ‚îÄ Camada Intermedi√°ria
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    ‚îÇ @canal = 'email'     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ wraps
          ‚ñº
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë CadastroPetSimples   ‚ïë  ‚óÑ‚îÄ‚îÄ‚îÄ Componente Base (n√∫cleo)
    ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
    ‚ïë pet.save             ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

## üéØ Ordem de Execu√ß√£o (Ida)

```
1Ô∏è‚É£  AutenticadorDecorator.cadastrar(pet)
    ‚îú‚îÄ Verifica se @autenticado == true
    ‚îú‚îÄ ‚úÖ Se false: retorna { success: false, message: "Acesso negado" }
    ‚îî‚îÄ ‚úÖ Se true: chama super(pet) ‚Üí pr√≥ximo decorador
        ‚îÇ
        ‚ñº
2Ô∏è‚É£  ValidadorDecorator.cadastrar(pet)
    ‚îú‚îÄ Valida nome, idade, esp√©cie
    ‚îú‚îÄ ‚úÖ Se inv√°lido: retorna { success: false, message: "Valida√ß√£o falhou" }
    ‚îî‚îÄ ‚úÖ Se v√°lido: chama super(pet) ‚Üí pr√≥ximo decorador
        ‚îÇ
        ‚ñº
3Ô∏è‚É£  NotificadorDecorator.cadastrar(pet)
    ‚îî‚îÄ Chama super(pet) ‚Üí componente base
        ‚îÇ
        ‚ñº
4Ô∏è‚É£  CadastroPetSimples.cadastrar(pet)
    ‚îú‚îÄ Executa pet.save
    ‚îî‚îÄ Retorna { success: true/false, message: "...", pet: pet }
```

## üîô Ordem de Retorno (Volta)

```
4Ô∏è‚É£  CadastroPetSimples
    ‚îî‚îÄ retorna { success: true, message: "Pet cadastrado", pet: pet }
        ‚îÇ
        ‚ñº
3Ô∏è‚É£  NotificadorDecorator
    ‚îú‚îÄ Recebe o resultado
    ‚îú‚îÄ Se success == true ‚Üí envia notifica√ß√£o
    ‚îú‚îÄ Adiciona resultado[:notificacao] = { enviada: true, canal: 'email' }
    ‚îî‚îÄ retorna resultado atualizado
        ‚îÇ
        ‚ñº
2Ô∏è‚É£  ValidadorDecorator
    ‚îî‚îÄ Apenas retorna o resultado recebido (valida√ß√£o j√° ocorreu na ida)
        ‚îÇ
        ‚ñº
1Ô∏è‚É£  AutenticadorDecorator
    ‚îî‚îÄ Apenas retorna o resultado recebido (autentica√ß√£o j√° ocorreu na ida)
        ‚îÇ
        ‚ñº
    PetsController
    ‚îî‚îÄ Recebe resultado final e decide o que fazer (redirect ou render)
```

## üí° Exemplo Pr√°tico - Cen√°rio de Sucesso

```ruby
# Controller cria a cadeia
pet = Pet.new(name: "Rex", species: "Dog", age: 3)

cadastro = CadastroPetSimples.new
cadastro = NotificadorDecorator.new(cadastro, canal: 'email')
cadastro = ValidadorDecorator.new(cadastro)
cadastro = AutenticadorDecorator.new(cadastro, autenticado: true, parceiro: "ONG ABC")

resultado = cadastro.cadastrar(pet)
```

### Passo a Passo:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. AutenticadorDecorator                                    ‚îÇ
‚îÇ    ‚úÖ Verifica: @autenticado == true                        ‚îÇ
‚îÇ    üìù Log: "Parceiro autenticado (ONG ABC)"                 ‚îÇ
‚îÇ    ‚û°Ô∏è  Continua para o pr√≥ximo decorador                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. ValidadorDecorator                                       ‚îÇ
‚îÇ    ‚úÖ Valida: nome = "Rex" (OK)                             ‚îÇ
‚îÇ    ‚úÖ Valida: age = 3 (OK)                                  ‚îÇ
‚îÇ    ‚úÖ Valida: species = "Dog" (OK)                          ‚îÇ
‚îÇ    üìù Log: "Valida√ß√£o bem-sucedida"                         ‚îÇ
‚îÇ    ‚û°Ô∏è  Continua para o pr√≥ximo decorador                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. NotificadorDecorator                                     ‚îÇ
‚îÇ    ‚û°Ô∏è  Passa para o componente base                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. CadastroPetSimples                                       ‚îÇ
‚îÇ    üíæ Executa: pet.save                                     ‚îÇ
‚îÇ    ‚úÖ Sucesso: Pet salvo no banco de dados                  ‚îÇ
‚îÇ    ‚Ü©Ô∏è  Retorna: { success: true, message: "...", pet: pet } ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. NotificadorDecorator (volta)                             ‚îÇ
‚îÇ    ‚úÖ Verifica: resultado[:success] == true                 ‚îÇ
‚îÇ    üìß Envia notifica√ß√£o via email                           ‚îÇ
‚îÇ    üìù Log: "NOTIFICA√á√ÉO enviada"                            ‚îÇ
‚îÇ    ‚ûï Adiciona: resultado[:notificacao] = {...}             ‚îÇ
‚îÇ    ‚Ü©Ô∏è  Retorna resultado atualizado                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. ValidadorDecorator (volta)                               ‚îÇ
‚îÇ    ‚Ü©Ô∏è  Retorna resultado sem altera√ß√µes                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. AutenticadorDecorator (volta)                            ‚îÇ
‚îÇ    ‚Ü©Ô∏è  Retorna resultado sem altera√ß√µes                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Resultado Final:                                            ‚îÇ
‚îÇ {                                                           ‚îÇ
‚îÇ   success: true,                                            ‚îÇ
‚îÇ   message: "Pet 'Rex' cadastrado com sucesso!",            ‚îÇ
‚îÇ   pet: #<Pet id:1, name:"Rex", ...>,                       ‚îÇ
‚îÇ   notificacao: {                                            ‚îÇ
‚îÇ     enviada: true,                                          ‚îÇ
‚îÇ     canal: 'email',                                         ‚îÇ
‚îÇ     mensagem: "Notifica√ß√£o enviada..."                     ‚îÇ
‚îÇ   }                                                         ‚îÇ
‚îÇ }                                                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## ‚ö†Ô∏è Exemplo Pr√°tico - Cen√°rio de Falha (N√£o Autenticado)

```ruby
cadastro = AutenticadorDecorator.new(
  ValidadorDecorator.new(
    CadastroPetSimples.new
  ),
  autenticado: false  # ‚ùå N√ÉO AUTENTICADO
)

resultado = cadastro.cadastrar(pet)
```

### Passo a Passo:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. AutenticadorDecorator                                    ‚îÇ
‚îÇ    ‚ùå Verifica: @autenticado == false                       ‚îÇ
‚îÇ    üö´ Bloqueia o cadastro                                   ‚îÇ
‚îÇ    üìù Log: "Acesso negado! Parceiro n√£o autenticado"        ‚îÇ
‚îÇ    ‚Ü©Ô∏è  Retorna imediatamente:                               ‚îÇ
‚îÇ       { success: false, message: "Acesso negado!", ... }   ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ    üö´ N√ÉO EXECUTA os decoradores seguintes                  ‚îÇ
‚îÇ    üö´ N√ÉO CHAMA super(pet)                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº (Interrompido aqui!)
         
    ValidadorDecorator        ‚Üê Nunca executado
         ‚îÇ
    CadastroPetSimples        ‚Üê Nunca executado
         ‚îÇ
    (Pet n√£o √© salvo)
```

## üìà Compara√ß√£o: Com vs Sem Decorator

### ‚ùå Sem Decorator (C√≥digo Acoplado)

```ruby
def create
  @pet = Pet.new(pet_params)
  
  # Tudo em um √∫nico m√©todo - dif√≠cil de manter!
  unless autenticado?
    return render :new, alert: "Acesso negado"
  end
  
  if @pet.name.blank? || @pet.age.nil?
    return render :new, alert: "Dados inv√°lidos"
  end
  
  if @pet.save
    enviar_notificacao(@pet)  # Acoplado
    redirect_to @pet, notice: "Sucesso"
  else
    render :new
  end
end
```

**Problemas**:
- ‚ùå C√≥digo acoplado e dif√≠cil de testar
- ‚ùå Dif√≠cil adicionar/remover comportamentos
- ‚ùå Viola√ß√£o do Single Responsibility Principle
- ‚ùå Dif√≠cil de reutilizar em outros contextos

### ‚úÖ Com Decorator (C√≥digo Desacoplado)

```ruby
def create
  @pet = Pet.new(pet_params)
  resultado = cadastrar_com_decorators(@pet)
  
  if resultado[:success]
    redirect_to @pet, notice: resultado[:message]
  else
    render :new, alert: resultado[:message]
  end
end

def cadastrar_com_decorators(pet)
  cadastro = CadastroPetSimples.new
  cadastro = NotificadorDecorator.new(cadastro)
  cadastro = ValidadorDecorator.new(cadastro)
  cadastro = AutenticadorDecorator.new(cadastro, autenticado: true)
  cadastro.cadastrar(pet)
end
```

**Vantagens**:
- ‚úÖ Cada decorador tem uma responsabilidade √∫nica
- ‚úÖ F√°cil testar cada componente isoladamente
- ‚úÖ F√°cil adicionar/remover comportamentos
- ‚úÖ Decoradores podem ser reutilizados em outros contextos
- ‚úÖ Ordem pode ser facilmente alterada

## üéì Conceitos-Chave para Iniciantes

### 1. Wrapping (Encapsulamento)

Cada decorador "envolve" o componente anterior:

```
AutenticadorDecorator(
  ValidadorDecorator(
    NotificadorDecorator(
      CadastroPetSimples()
    )
  )
)
```

### 2. Delega√ß√£o via `super`

```ruby
class MeuDecorator < CadastroPetDecorator
  def cadastrar(pet)
    puts "Antes"
    resultado = super(pet)  # Chama o pr√≥ximo na cadeia
    puts "Depois"
    resultado
  end
end
```

### 3. Interrup√ß√£o da Cadeia

Se um decorador retorna sem chamar `super`, a cadeia √© interrompida:

```ruby
def cadastrar(pet)
  return { success: false, message: "Bloqueado!" } unless valido?
  super(pet)  # S√≥ chama se v√°lido
end
```

---

## üîó Integra√ß√£o com o Projeto Rails

```
HTTP Request
     ‚Üì
routes.rb ‚Üí define rota POST /pets
     ‚Üì
PetsController#create
     ‚Üì
PetFactory.create(params) ‚Üí Padr√£o Factory (criacional)
     ‚Üì
cadastrar_com_decorators(pet) ‚Üí Padr√£o Decorator (estrutural)
     ‚Üì
Cadeia de Decoradores
     ‚Üì
Resultado ‚Üí redirect ou render
```

---

**üìå Dica**: Para entender melhor, execute os exemplos em `lib/exemplos_decorator.rb` e observe os logs!
